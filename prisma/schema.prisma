// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  USER
}

model User {
  id          Int       @id @default(autoincrement())
  firstName    String
  lastName    String
  email       String?    @unique
  phoneNumber String?    @unique
  password    String
  address     String
  catInfo     CatInfo[]
  booking     Booking[]
  role        Role      @default(USER)
}

model CatInfo {
  id               Int                @id @default(autoincrement())
  catName          String
  age              String
  breed            String
  healthInfo       String
  User             User?              @relation(fields: [userId], references: [id])
  userId           Int?
  catDetailBooking CatDetailBooking[]
}

model Booking {
  id               Int                @id @default(autoincrement())
  checkInDate      DateTime
  checkOutDate     DateTime
  totalPrice       Float
  bookingStatus    String
  User             User?              @relation(fields: [userId], references: [id])
  userId           Int?
  rooms            BookingRoom[]
  catDetailBooking CatDetailBooking[]
}

enum RoomStatus {
  AVAILABLE
  UNAVAILABLE
  MAINTENANCE
  CLEANING
}

model Roomtype {
  id           Int           @id @default(autoincrement())
  roomType     String
  roomPerNight Float
  roomStatus   RoomStatus    @default(AVAILABLE)
  booking      BookingRoom[]
}

model CatDetailBooking {
  id        Int      @id @default(autoincrement())
  CatInfo   CatInfo? @relation(fields: [catInfoId], references: [id])
  catInfoId Int?
  Booking   Booking? @relation(fields: [bookingId], references: [id])
  bookingId Int?
  @@unique([catInfoId, bookingId])
}

model BookingRoom {
  bookingId  Int 
  roomtypeId Int
  Booking    Booking   @relation(fields: [bookingId], references: [id])
  Roomtype   Roomtype? @relation(fields: [roomtypeId], references: [id])
  @@id([bookingId, roomtypeId])
}
